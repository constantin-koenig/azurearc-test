{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Azure Arc Dokumentation","text":""},{"location":"#universitat-bern-abt-informatikdienste","title":"Universit\u00e4t Bern Abt. Informatikdienste","text":"<p>Herzlich Willkommen zur Dokumentation Azure Arc der UniBe. Im Sommer 2023 wurde Azure Arc von der UniBe auf m\u00f6gliche Integration getestet und hier dokumentiert.   </p> <p> Zur Dokumentation </p> <p> </p> Mitwirkende Anointan Balasingam Constantin K\u00f6nig Michael Pfister Michael Rolli"},{"location":"aadrights/","title":"AADSSH Berechtigungen","text":"<p>Nachdem wir die AADSSH Erweiterung erfolgreich installiert haben, k\u00f6nnen wir nun den Zugriff konfigurieren.</p>"},{"location":"aadrights/#rollen","title":"Rollen","text":"<p>Es gibt folgende Rollen f\u00fcr die Erweiterung</p> Rolle Login Root Rechte <code>Virtual Machine User Login</code> <code>Virtual Machine Administrator Login</code>"},{"location":"aadrights/#konfiguration","title":"Konfiguration","text":""},{"location":"aadrights/#fur-die-ganze-ressourcen-gruppe","title":"F\u00fcr die ganze Ressourcen Gruppe","text":"<ol> <li>Gehen Sie zu Ihrer Ressourcen Gruppe </li> <li>Klicken Sie auf Access Control (IAM) </li> <li>Dann auf Add und Add role assignment </li> <li>Nun suchen sie nach Virtual Machine User Login oder Virtual Machine Administrator Login </li> <li>Klicken Sie die Rolle an     </li> <li>Weiter mit Next </li> <li>W\u00e4hlen Sie nun unter Select members Ihre gew\u00fcnschten Benutzer</li> <li>Best\u00e4tigen Sie mit Review + assign</li> </ol>"},{"location":"aadrights/#fur-einzelne-arc-server","title":"F\u00fcr einzelne Arc Server.","text":"<ol> <li>Gehen Sie zu Ihrer Ressourcen Gruppe </li> <li>W\u00e4hlen Sie den gew\u00fcnschten Arc Server aus </li> <li>Klicken Sie auf Access Control (IAM) </li> <li>Dann auf Add und Add role assignment </li> <li>Nun suchen sie nach Virtual Machine User Login oder Virtual Machine Administrator Login </li> <li>Klicken Sie die Rolle an     </li> <li>Weiter mit Next </li> <li>W\u00e4hlen Sie nun unter Select members Ihre gew\u00fcnschten Benutzer</li> <li>Best\u00e4tigen Sie mit Review + assign</li> </ol> <p> Verbinden mit Arc Server</p>"},{"location":"aadsshextension/","title":"SSH und AADSSH Erweiterung","text":"<p>Diese Dokumentation setzt voraus, dass Sie eine aktuelle Version (2.7) auf Ihrem Ger\u00e4t installiert haben.</p> <p>Hier kommen Sie zur Installation </p>"},{"location":"aadsshextension/#ssh-port-offnen-fur-azure","title":"SSH Port \u00f6ffnen f\u00fcr Azure","text":"Azure Client<pre><code>az login\nsudo azcmagent config set incomingconnections.ports 22\naz extension add --name ssh\naz extension update --name ssh\n</code></pre>"},{"location":"aadsshextension/#installation-extension-uber-das-portal","title":"Installation Extension \u00fcber das Portal","text":"<ul> <li>In einem Browser portal.azure.com \u00f6ffnen und anmelden</li> <li>\u00dcber Suchfenster Azure Arc suchen und \u00f6ffnen</li> <li>Den gew\u00fcnschten Server ausw\u00e4hlen</li> <li> <p>Im Menu Fenster links unter Settings auf Extension klicken und auf Add klicken </p> </li> <li> <p>Azure AD based SSH-Login ausw\u00e4hlen </p> </li> <li> <p>Auf Next klicken, erstellen und einige Zeit warten</p> </li> </ul>"},{"location":"aadsshextension/#installation-extension-uber-azcli","title":"Installation Extension \u00fcber AzCLI","text":"Azure Client<pre><code>az connectedmachine extension create --machine-name \"euerArcServer\" --name \"AADSSHLogin\" --location \"switzerlandnorth\" --type \"AADSSHLoginForLinux\" --publisher \"Microsoft.Azure.ActiveDirectory\" --resource-group \"eureRessourcenGruppe\"\n</code></pre> <p> AADSSH Berechtigungen Automatisierung</p>"},{"location":"arc/","title":"Was ist Azure Arc","text":"<p>Azure Arc ist ein Dienst von Microsoft, der Unternehmen die Verwaltung von IT-Ressourcen in einer hybriden Umgebung oder \u00fcber verschiedene Cloud-Anbieter erm\u00f6glicht. Mit Azure Arc ist es m\u00f6glich die lokalen Rechenzentren mit der Azure-Cloud zu verbinden und von den Vorteilen der Azure-Services zu profitieren, ohne dass man sich auf eine einzige Plattform beschr\u00e4nken muss.</p> <p>Azure Arc erm\u00f6glicht es, dass Sie virtuellen Maschinen, Kubernetes-Cluster, Datenbanken und andere Ressourcen zentral \u00fcber das Azure-Portal steuern und \u00fcberwachen k\u00f6nnen. Dies bietet mehr Flexibilit\u00e4t, Agilit\u00e4t und Skalierbarkeit der IT-Infrastrukturen.</p> <p> Manuelle Installation Automatisierung</p>"},{"location":"automation/","title":"Automatisierung","text":""},{"location":"automation/#service-principal","title":"Service Principal","text":""},{"location":"automation/#erstellung","title":"Erstellung","text":"<p>Zuerst ben\u00f6tigen wir einen SP.   Falls Sie keinen SP f\u00fcr Azure Arc haben, k\u00f6nnen Sie unter folgendem Link einen erstellen.</p>"},{"location":"automation/#secret-setzen","title":"Secret setzen","text":"<p>Als n\u00e4chstes setzen wir einen Secret f\u00fcr den SP.    </p> <ol> <li>Link zu Ihrem aktiven SP.   </li> <li>Klicken Sie auf Ihren erstellten SP.    </li> <li>Dann auf \"Certificates &amp; secrets\".  </li> <li>Nun klicken Sie auf \"New client secret\"  </li> <li>Geben Sie die Daten Ihren W\u00fcnschen entsprechend an.   </li> <li>Kopieren Sie nun den Value des Secrets und speichern Sie diesen vor\u00fcbergehend ab.   </li> </ol>"},{"location":"automation/#berechtigugen-setzen","title":"Berechtigugen setzen","text":"<p>Nun setzen wir die Berechtigungen des SP  </p> <ol> <li>Unter folgendem Link kommen Sie in Ihre Ressourcen Gruppen  </li> <li>W\u00e4hlen Sie Ihre Ressource Gruppe aus und klicken Sie auf \"Access Control (IAM)\".     </li> <li>Klicken Sie auf \"Add\" und dann \"Add role assignment\".    </li> <li>Nun sollten Sie folgenden Bildschirm sehen: </li> <li>Suchen sie nach \"Azure Connected Machine Onboarding\".    </li> <li>W\u00e4hlen Sie die Rolle aus und klicken Sie auf \"Next\".     </li> <li>Klicken Sie auf \"Select Members\".    </li> <li>Geben Sie nun den ganzen Namen Ihres SP ein, ansonsten wird dieser m\u00f6glicherweise nicht angezeigt.  </li> <li>W\u00e4hlen Sie den SP aus und Klicken Sie auf \"Select\".  </li> <li>Nun k\u00f6nnen Sie auf \"Review + assign\" klicken.   </li> </ol>"},{"location":"automation/#script-erzeugen","title":"Script erzeugen","text":"<ol> <li>\u00d6ffnen Sie folgenden Link </li> <li>Klicken Sie auf \"Add\"    </li> </ol> <p>  3. Dann auf \"Servers\"   </p> <p>  4. Klicke auf \"Generate Script\" unter \"Add multiple Servers\"   </p> <p> 5. weiter mit Next 6. Nun sollte folgender Bildschirm sichtbar sein:</p> <p> 7. F\u00fcllen Sie die Textfelder entsprechend Ihrer Konfiguration aus. 8. Sobald Sie alles ausgef\u00fcllt haben, sollten Sie nun ein Bash Script sehen.   9. Laden Sie dies herunter und f\u00fcgen Sie in der Zeile 3 nun Ihre SP-K\u00fcrzel, welches Sie vorhin kopiert haben, ein.  </p>"},{"location":"automation/#autmations-script-von-github","title":"Autmations Script von Github","text":"<p>Das Script unterst\u00fctzt aktuell nur Ubuntu und Rocky Linux.</p> <p>Das Script automatisiert folgendes:    </p> <ul> <li> <p>Einbindung Server in Azure Arc</p> </li> <li> <p>Installation Az CLI     </p> </li> <li> <p>Port\u00f6ffnung f\u00fcr SSH \u00fcber Azure  </p> </li> <li> <p>AADSSH Extension wird hinzugef\u00fcgt     </p> </li> </ul> <p> AADSSH Berechtigungen </p>"},{"location":"azcli/","title":"Azure Client installation","text":""},{"location":"azcli/#windows","title":"Windows","text":"Powershell<pre><code>$ProgressPreference = 'SilentlyContinue'; Invoke-WebRequest -Uri https://aka.ms/installazurecliwindows -OutFile .\\AzureCLI.msi; Start-Process msiexec.exe -Wait -ArgumentList '/I AzureCLI.msi /quiet'; Remove-Item .\\AzureCLI.msi\n</code></pre>"},{"location":"azcli/#macos","title":"MacOs","text":"Bash<pre><code>brew update &amp;&amp; brew install azure-cli\n</code></pre>"},{"location":"azcli/#ubuntu","title":"Ubuntu","text":"Bash<pre><code>curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash\n</code></pre>"},{"location":"azcli/#rocky","title":"Rocky","text":"Bash<pre><code>sudo dnf install azure-cli\n</code></pre> <p>Link zur Microsoft Dokumentation</p>"},{"location":"connect/","title":"Mit AzCLI auf Arc Server verbinden","text":"<p>Diese Dokumentation setzt voraus, dass Sie eine aktuelle Version (2.7) auf Ihrem Ger\u00e4t installiert haben.</p> <p>Hier kommen Sie zur Installation </p>"},{"location":"connect/#aad-empfohlen","title":"AAD (empfohlen)","text":"<pre><code>az login\naz ssh arc --subscription \"eureSubscriptionID\" --resource-group \"eureRessourcenGruppe\" --name \"nameDesServers\" \n</code></pre>"},{"location":"connect/#lokaler-benutzer","title":"Lokaler Benutzer","text":""},{"location":"connect/#passwort","title":"Passwort","text":"<pre><code>az ssh arc --subscription \"eureSubscriptionID\" --resource-group \"eureRessourcenGruppe\" --name \"nameDesServers\" --local-user \"lokalerBenutzer\"\n</code></pre>"},{"location":"connect/#ssh-key","title":"SSH Key","text":"<pre><code>az ssh arc --subscription \"eureSubscriptionID\" --resource-group \"eureRessourcenGruppe\" --name \"nameDesServers\" --local-user \"lokalerBenutzer\" --private-key-file \"/pfad/zum/privatkey\"\n</code></pre>"},{"location":"server/","title":"Server in Azure Arc einbinden","text":""},{"location":"server/#folgende-schritte-im-portalazurecom-ausfuhren","title":"Folgende Schritte im portal.azure.com ausf\u00fchren:","text":"<ul> <li>In einem Browser portal.azure.com \u00f6ffnen und anmelden</li> <li>\u00dcber Suchfenster Azure Arc suchen und \u00f6ffnen</li> <li>Auf Add klicken </li> <li>Eine der drei hier aufgelisteten L\u00f6sungen ausw\u00e4hlen </li> <li>\u00fcberpr\u00fcfen, ob die Anforderungen erf\u00fcllt sind </li> <li>Subscription, Resource group, Region, Operating System angeben </li> <li>(Optional) Tags setzen </li> <li>Skript herunterladen</li> <li>Beschreibung durchlesen </li> <li>F\u00fchre das Script dann auf dem gew\u00fcnschten Server aus</li> </ul> <p>Link zur Microsoft Dokumentation</p> <p> SSH und AADSSH</p>"}]}